<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 합격자소서 -->
<mapper namespace="mapper.letter-mapper">
	<!-- 합격자소서 리스트 -->
	<select id="letterListData" resultType="SelfVO" parameterType="hashmap">
	SELECT sno,ssubject,sname,sindutype,num
	FROM (SELECT sno,ssubject,sname,sindutype,rownum as num
	FROM (SELECT sno,ssubject,sname,sindutype
	FROM selfletter ORDER BY sno DESC))
	WHERE num BETWEEN #{start} AND #{end}
	
	</select>
	<!-- 합격자소서 리스트 총페이지 -->
	<select id="letterTotalPage" resultType="int">
   	SELECT CEIL(COUNT(*)/10.0) FROM selfletter
  	</select>
  	
  	<!-- 자소서 상세보기 -->
  	<select id="letterDetailData" resultType="SelfVO" parameterType="int">
	SELECT * FROM selfletter
	WHERE sno=#{sno}
	</select>
	
	<!-- 자소서 작성 -->
	<insert id="letterInsert" parameterType="SelfVO">
	<selectKey keyProperty="sno" resultType="int" order="BEFORE">
		SELECT NVL(MAX(sno)+1,1) as sno FROM selfletter
	</selectKey>
	INSERT INTO selfletter(sno,ssubject,sname,sindutype,sq1,sa1,sq2,sa2,sq3,sa3)
	VALUES(
		#{sno},
		#{ssubject},
		#{sname},
		#{sindutype},
		#{sq1},
		#{sa1},
		#{sq2},
		#{sa2},
		#{sq3},
		#{sa3}
	)
	</insert>
	
</mapper>